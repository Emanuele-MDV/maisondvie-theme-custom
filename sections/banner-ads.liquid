{% if section.settings.is_first == true %}
  <link rel="stylesheet" href="{{ 'banner-ads.css' | asset_url }}" media="print" onload="this.media='all'">
{% endif %}

{% comment %} Counting the slides --> if more than one it activates the slider {% endcomment %}

{% assign count = 0 %}
{% for block in section.blocks %}
       {% assign count = count | plus: 1 %}
{% endfor %}

{% if count >= 2 %}
  <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js" defer></script>
  <link href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide-core.min.css" rel="stylesheet" media="print" onload="this.media='all'"></link>

  <script>
    document.addEventListener( 'DOMContentLoaded', function() {
  
      var splide = new Splide( '#{{ section.settings.custom_ID }}', {
        autoplay : 'play',
        perPage: 1,
        rewind : true,
        arrows :  false,
        pagination : false,
        interval : 4000
      } );
      splide.mount();

      
    } );
  </script>
{% endif %}



{% comment %} Carousel container, same objects even if is carousel or not {% endcomment %}

{% if count >= 2 %}<div id="{{ section.settings.custom_ID }}" class="splide">{% endif %}

  {% if section.settings.section_title != empty or section.settings.section_description != empty %}
  <div class="page-width section-title{% if section.settings.show_text == true %} hide{% endif %}">
    {% if section.settings.section_title != empty %}<h2 class="{{ section.settings.header_size }}">{{ section.settings.section_title }}</h2>{% endif %}
    {% if section.settings.section_description != empty %}<p>{{ section.settings.section_description }}</p>{% endif %}
  </div>
  {% endif %}

  {% if count >= 2 %}
    <div class=" splide__track">
      <ul class="splide__list">
      {% endif %}
    
      {% for block in section.blocks %}
        
        {% if count >= 2 %}<li class="splide__slide">{% endif %}
  
          
          <article class="banner-container page-width">
            
            <div class="bg-{{ block.settings.bg_color }} text-align-{{ block.settings.text_align }}">
              <figure>
    
                {% if block.settings.bg_img == false %}
                
                {% assign image = block.settings.slide_image %}
                <img 
                src="{{ image.src | img_url: 'x360' }}" 
                alt="{% if imge.alt %}{{ image.alt | escape }}{% else %}{{ block.settings.slide_title }}{% endif %}" 
                srcset="
                {% if image.width > 370 %}{{ image.src | img_url: '375x500', crop : 'top' }} 375w{% endif %},
                {% if image.width > 420 %}{{ image.src | img_url: '420x620', crop : 'top' }} 420w{% endif %},
                {% if image.width > 500 %}{{ image.src | img_url: '620x768', crop : 'top' }} 520w{% endif %}
                " 
                sizes="
                (min-width: 1024px) 520px,
                (min-width: 720px) 420px,
                (min-width: 360px) 375px,
                100vw"
                width="{{ image.width }}"
                height="{{ image.height }}"
                {% unless forloop.first %}loading="lazy"{% endunless %}
                />
    
                {% else %}
    
                <img 
                src="{{ image.src | img_url: 'x360' }}" 
                alt="{% if imge.alt %}{{ image.alt | escape }}{% else %}{{ block.settings.slide_title }}{% endif %}" 
                srcset="
                {% if image.width > 420 %}{{ image.src | img_url: '420x620', crop : 'center' }} 420w{% endif %},
                {% if image.width > 550 %}{{ image.src | img_url: '550x768', crop : 'center' }} 520w{% endif %},
                {% if image.width > 1024 %}{{ image.src | img_url: '1024x768', crop : 'center' }} 520w{% endif %},
                {% if image.width > 1440 %}{{ image.src | img_url: '1440x768', crop : 'center' }} 520w{% endif %},
                {% if image.width > 1600 %}{{ image.src | img_url: '1650x768', crop : 'center' }} 520w{% endif %},
                " 
                sizes="
                (min-width: 1600px) 1650px,
                (min-width: 1440px) 1440px,
                (min-width: 1024px) 1024px,
                (min-width: 720px) 550px,
                (min-width: 360px) 420px,
                100vw"
                width="{{ image.width }}"
                height="{{ image.height }}"
                {% unless section.settings.above_the_line == true and forloop.first %}loading="lazy"{% endunless %}
                />
    
                {% endif %}
                
              </figure>
              <div class="banner-content">
                {% if block.settings.slide_title %}<h3>{{ block.settings.slide_title }}</h3>{% endif %}
                {% if block.settings.slide_text %}<p>{{ block.settings.slide_text }}</p>{% endif %}
                {% if block.settings.slide_link %}<a href="{{ block.settings.slide_link }}" class="btn outline"><span>{{ block.settings.text_btn }}</span>{% render 'icon-arrow' %}</a>{% endif %}
              </div>
            </div>
            
          </article>
  
          
        {% if count >= 2 %}</li>{% endif %}
        
      {% endfor %}
      
    {% if count >= 2 %}
      </ul>
    </div>
  </div>
  {% endif %}
  





{% schema %}
  {
    "name": "Banner Ads",
    "tag":"section",
    "class":"banner-slider-links",
    "settings": [
      {
        "type":"checkbox",
        "id":"is_first",
        "default":false,
        "label":"Load Script files?"
      },
      {
        "type":"checkbox",
        "id":"above_the_line",
        "label":"Check this if the slider is visible on page load",
        "default": false
      },
      {
        "type":"text",
        "id":"section_title",
        "label":"Add a title for the slider"
      },
      {
        "type":"select",
        "id":"header_size",
        "label":"Title font size",
        "options":[
          {
            "value": "h2",
            "label": "t:sections.image-banner.settings.image_height.options__1.label"
          },
          {
            "value": "h1",
            "label": "t:sections.image-banner.settings.image_height.options__2.label"
          },
          {
            "value": "h0",
            "label": "t:sections.image-banner.settings.image_height.options__3.label"
          }
        ],
        "default":"h1"
      },
      {
        "type":"text",
        "id":"section_description",
        "label":"Add a description for the slider"
      },
      {
        "type":"checkbox",
        "id":"show_text",
        "default":false,
        "label":"Do you want to hide the title and text?"
      },
      {
        "type":"text",
        "id":"custom_ID",
        "label":"Add an ID. Mandatory!",
        "default":"banner-container"
      }
    ],
    "blocks":[
      {
        "type":"heading",
        "name":"Slide",
        "settings":[
          {
            "type":"text",
            "id":"slide_title",
            "label":"Add a title on the slide"
          },
          {
            "type":"text",
            "id":"slide_text",
            "label":"Add a caption on the slide"
          },
          {
            "type":"checkbox",
            "id":"set_timer",
            "label":"Set timer date?"
          },
          {
            "type":"image_picker",
            "id":"slide_image",
            "label":"Add an image on the slide"
          },
          {
            "type":"checkbox",
            "id":"bg_img",
            "label":"Use the image as a background"
          },
          {
            "type":"url",
            "id":"slide_link",
            "label":"Add a button on the slide"
          },
          {
            "type":"text",
            "id":"text_btn",
            "label":"Customize this slide's button",
            "default":"Shop now"
          },
          {
            "type":"select",
            "id":"text_align",
            "label":"Text orientation",
            "options":[
              {
                "value":"left",
                "label":"Left"
              },
              {
                "value":"center",
                "label":"Center"
              },
              {
                "value":"right",
                "label":"Right"
              }
            ],
            "default":"left"
          },
          {
            "type":"select",
            "id":"bg_color",
            "label":"Select a background color for the slide",
            "options":[
              {
                "value":"white",
                "label":"White"
              },
              {
                "value":"silver",
                "label":"Silver"
              },
              {
                "value":"golden",
                "label":"Golden"
              },
              {
                "value":"black",
                "label":"Black"
              },
              {
                "value":"pink",
                "label":"Pink"
              },
              {
                "value":"blue",
                "label":"Blue"
              },
              {
                "value":"red",
                "label":"Red"
              },
              {
                "value":"green",
                "label":"Green"
              }
            ]
          }
        ]
      }
    ],
    "presets":[
      {
        "name":"Banner with Ads"
      }
    ]
  }
{% endschema %}
